var openpgp = require('openpgp');

function pgpMessageEncrypter(key, text, done) {
    try {
        var publicKey = openpgp.key.readArmored(key);
        var msg = openpgp.message.fromText(text);
        var encrypted = msg.encrypt(publicKey.keys);
        var armored = openpgp.armor.encode(openpgp.enums.armor.message, encrypted.packets.write());

        console.log('oh');
        done(null, armored);
    }
    catch (e) {
        console.error(e.stack);
        done(e);
    }
}

module.exports = pgpMessageEncrypter;
